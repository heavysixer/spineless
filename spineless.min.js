(function(c){var g=function(){return{controllers:{},helpers:{_default:function(a){return c.extend(!0,{},a)}}}},j=function(a,b,d){d="undefined"===typeof d?{}:d;return{controller:c(".controller[data-controller="+a+"]"),view:c(".controller[data-controller="+a+"] .view[data-action="+b+"]"),params:c.extend(!0,d,{controller:a,action:b})}},k=function(){return{parseRoute:function(a){for(var b=c.extend(!0,{},{controller:"application",action:"index"});"/"==a.charAt(0);)a=a.substr(1);0<a.length&&c.each(a.split("/"),
function(c,a){0===c&&(b.controller=a);1===c&&(b.action=a)});return b},route:function(a){a=this.parseRoute(a.attr("href")||c(a).attr("data-href"));this.get(a.controller,a.action,a.params)}}},l=function(){var a=c({});return{subscribe:function(){a.on.apply(a,arguments)},unsubscribe:function(){a.off.apply(a,arguments)},publish:function(){a.trigger.apply(a,arguments)}}},n=function(a){var b=this,d=function(a){c.each(a,function(a,d){var h=c(d),f,e,i;f=c(h).attr("data-template");void 0!==f&&(e=c(h),e=c(e).attr("data-locals"),
e=void 0!==e?c.parseJSON(e):{},i=c(".templates *[data-template-name="+f+"]").html(),h.html(c.mustache(i,b.app.helpers.hasOwnProperty(f)?b.app.helpers[f].apply(b.app,[e]):b.app.helpers._default(e))))})};this.app=new g;c.extend(!0,this.app,new k);c.extend(!0,this.app,new l);this.app.get=function(a,m,g){b.request=new j(a,m,g);b.app.request=b.request;c("body").removeClass("rendered");c("html,body").animate({scrollTop:0},1);b.request.controller&&b.request.view?(c(".view.active").removeClass("active"),
c(".controller.active").removeClass("active"),b.request.view.addClass("active"),b.request.controller.addClass("active"),a=b.request.view.find("*[data-template]")):a=[];b.app.controllers.hasOwnProperty(b.request.params.controller)&&b.app.controllers[b.request.params.controller].hasOwnProperty(b.request.params.action)?b.app.controllers[b.request.params.controller][b.request.params.action].apply(b.app,[a,b.request]):d(a);c("body").attr("data-controller",b.request.params.controller);c("body").attr("data-action",
b.request.params.action);c("body").addClass("rendered");b.app.publish("afterRender",b.app)};this.app.render=d;(function(a){c(document).on("click",".route",function(a){a.preventDefault();b.app.route(c(this))});c.extend(!0,b.app,a)})(a);return this.app};c.spineless=function(a){return new n(a)}})(jQuery);
